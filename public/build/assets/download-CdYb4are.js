import{j as e,r as x,a as N}from"./app-dwFro-sa.js";import{A as S}from"./ascii-text-B8CCltK_.js";import{c as _,a as z,B as k}from"./button-B6mWijBL.js";import{I}from"./input-BJBIEZJP.js";import{L as C}from"./label-CcUjhAue.js";import{K as E}from"./key-tkuQ9azt.js";import{L as D}from"./loader-circle-DSLIuaPK.js";import{S as M}from"./search-0hHhGWru.js";import{D as P}from"./download-C9iXid2o.js";/* empty css            */import"./index-B3xlNdz0.js";/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const R=[["path",{d:"M12 2a10 10 0 0 1 7.38 16.75",key:"175t95"}],["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["path",{d:"M2.5 8.875a10 10 0 0 0-.5 3",key:"1vce0s"}],["path",{d:"M2.83 16a10 10 0 0 0 2.43 3.4",key:"o3fkw4"}],["path",{d:"M4.636 5.235a10 10 0 0 1 .891-.857",key:"1szpfk"}],["path",{d:"M8.644 21.42a10 10 0 0 0 7.631-.38",key:"9yhvd4"}]],F=_("clock-fading",R);function h({className:p,...l}){return e.jsx("div",{"data-slot":"card",className:z("bg-card text-card-foreground flex flex-col gap-6 rounded-xl border py-6 shadow-sm",p),...l})}function V(){var w;const[p,l]=x.useState(!1),[o,v]=x.useState(""),[t,u]=x.useState(null),[y,a]=x.useState(null),j=t!==null&&(t==null?void 0:t.count)>0,b=async r=>{var n,i,c,d,m;if(r.preventDefault(),l(!0),u(null),a(null),!o.trim()){a("Please enter a license key"),l(!1);return}try{const s=await N.post(route("download.search"),{license_key:o});s.data.error?a(s.data.error):(u(null),s.data.files&&s.data.files.length===0&&a("No files found for this license key")),console.log("Search response:",s.data),u(s.data)}catch(s){console.error("Error fetching files:",s),((n=s.response)==null?void 0:n.status)===403?a("Invalid or inactive license key"):((i=s.response)==null?void 0:i.status)===422?a("Invalid license key format"):((c=s.response)==null?void 0:c.status)===429?a("Too many requests. Please try again later."):(m=(d=s.response)==null?void 0:d.data)!=null&&m.error?a(s.response.data.error):a("Failed to search files. Please try again."),u(null)}finally{l(!1)}},L=async r=>{var n,i,c,d,m;try{a(null);const s=await N.post(route("download.file"),{file_id:r.id,license_key:o},{responseType:"blob"}),g=window.URL.createObjectURL(new Blob([s.data])),f=document.createElement("a");f.href=g,f.setAttribute("download",r.custom_name||r.file_name||"download"),document.body.appendChild(f),f.click(),f.remove(),window.URL.revokeObjectURL(g)}catch(s){console.error("Error downloading file:",s),((n=s.response)==null?void 0:n.status)===403?a("License key is invalid or expired"):((i=s.response)==null?void 0:i.status)===404?a("File not found"):((c=s.response)==null?void 0:c.status)===429?a("Too many requests. Please try again later."):(m=(d=s.response)==null?void 0:d.data)!=null&&m.error?a(s.response.data.error):a("Failed to download file. Please try again.")}};return e.jsxs("main",{className:"flex justify-center items-center min-h-screen w-full",children:[e.jsx(S,{text:"Skynet",className:"absolute inset-0 -translate-y-[12rem] overflow-hidden z-10"}),e.jsxs("div",{className:"flex flex-col gap-4 w-[40rem] z-50",children:[j&&e.jsx(h,{className:"p-4 animate-in fade-in-50 slide-in-from-bottom-4 duration-500",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-lg font-semibold",children:t==null?void 0:t.product_name}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(F,{className:"size-4 text-primary"}),e.jsx("span",{className:"text-lg font-semibold",children:t==null?void 0:t.time_left_human})]})]})}),e.jsx(h,{className:"p-4",children:e.jsxs("form",{className:"flex flex-row gap-2",onSubmit:b,children:[e.jsxs("div",{className:"relative w-full",children:[e.jsx(I,{className:"peer ps-9 text-center flex-1",placeholder:"Enter your license key",type:"text",value:o,onChange:r=>v(r.target.value)}),e.jsx("div",{className:"text-muted-foreground/80 pointer-events-none absolute inset-y-0 start-0 flex items-center justify-center ps-3 peer-disabled:opacity-50",children:e.jsx(E,{className:"size-4"})})]}),e.jsx(k,{type:"submit",disabled:p||!o,className:"w-9 z-40",children:p?e.jsx(D,{className:"animate-spin size-4"}):e.jsx(M,{className:"size-4"})})]})}),j&&e.jsx(h,{className:"p-4 flex flex-col gap-4 animate-in fade-in-50 slide-in-from-top-4 duration-500",children:(w=t==null?void 0:t.files)==null?void 0:w.map((r,n)=>e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{children:r.custom_name}),e.jsx(k,{className:"size-8",onClick:()=>L(r),children:e.jsx(P,{})})]},n))}),y&&e.jsx(C,{className:"text-red-600 text-center",children:y})]})]})}export{V as default};
