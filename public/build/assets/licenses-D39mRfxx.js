import{j as e,r as o,b as fe,S as D,a as be,A as ve}from"./app-dwFro-sa.js";import{u as B,a as U,P as W,F as se,b as f,c as b,d as v,S as I,e as y,f as A,g as K,h as q,i as h,j as S,B as C,o as O,s as L,Q as F,T as ye,C as Se,m as we,n as Ne,p as Ce,q as ke,r as G,t as _e,v as Y,w as Pe,x as X,y as De,z as Le,A as T,D as Me,E as ze,G as Re,H as Te,I as Fe,J as Ie,K as Ae,L as Z,M as N,N as Ke,O as qe}from"./main-layout-wAq1HGrI.js";import{c as k,a as te,B as u,h as ne}from"./button-B6mWijBL.js";import{D as ae,a as Ve,b as ie,c as re,d as oe,e as le,f as He}from"./dialog-pPcYSAHr.js";import{I as V}from"./input-BJBIEZJP.js";import{D as Ee}from"./download-C9iXid2o.js";import{L as Q}from"./loader-circle-DSLIuaPK.js";import{T as Ge,a as Be,b as Ue,C as $e}from"./app-sidebar-header-D5HnlU0T.js";import{L as $}from"./label-CcUjhAue.js";import{S as ee}from"./separator-j9Vj_Ecg.js";import{u as Oe}from"./useQuery-B1uraHXk.js";import{K as Qe}from"./key-tkuQ9azt.js";/* empty css            */import"./search-0hHhGWru.js";import"./index-B3xlNdz0.js";/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Je=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]],We=k("calendar",Je);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ye=[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],Xe=k("clock",Ye);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ze=[["path",{d:"M12 20v2",key:"1lh1kg"}],["path",{d:"M12 2v2",key:"tus03m"}],["path",{d:"M17 20v2",key:"1rnc9c"}],["path",{d:"M17 2v2",key:"11trls"}],["path",{d:"M2 12h2",key:"1t8f8n"}],["path",{d:"M2 17h2",key:"7oei6x"}],["path",{d:"M2 7h2",key:"asdhe0"}],["path",{d:"M20 12h2",key:"1q8mjw"}],["path",{d:"M20 17h2",key:"1fpfkl"}],["path",{d:"M20 7h2",key:"1o8tra"}],["path",{d:"M7 20v2",key:"4gnj0m"}],["path",{d:"M7 2v2",key:"1i4yhu"}],["rect",{x:"4",y:"4",width:"16",height:"16",rx:"2",key:"1vbyd7"}],["rect",{x:"8",y:"8",width:"8",height:"8",rx:"1",key:"z9xiuo"}]],es=k("cpu",Ze);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ss=[["rect",{x:"14",y:"4",width:"4",height:"16",rx:"1",key:"zuxfzm"}],["rect",{x:"6",y:"4",width:"4",height:"16",rx:"1",key:"1okwgv"}]],ts=k("pause",ss);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ns=[["polygon",{points:"6 3 20 12 6 21 6 3",key:"1oa8hb"}]],as=k("play",ns);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const is=[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]],rs=k("rotate-ccw",is);function ce({className:n,...r}){return e.jsx("textarea",{"data-slot":"textarea",className:te("border-input placeholder:text-muted-foreground focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive dark:bg-input/30 flex field-sizing-content min-h-16 w-full rounded-md border bg-transparent px-3 py-2 text-base shadow-xs transition-[color,box-shadow] outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",n),...r})}const os=O({product_id:F().min(1,"Product is required"),duration_unit:L().min(1,"Duration is required"),duration_value:F().min(1,"Duration value is required"),amount:F().min(1,"Amount is required"),description:L().optional()}),ls=({products:n,disabled:r=!1})=>{const[m,g]=o.useState(!1),[p,j]=o.useState(!1),[w,_]=o.useState("create"),l=B({resolver:U(os),defaultValues:{duration_unit:"months",duration_value:1,amount:1}});function P(i){j(!0);const c={...i,duration:ne(i.duration_unit,i.duration_value),is_lifetime:i.duration_unit==="lifetime",is_export:w==="export"};try{D.post(route("licenses.create"),c,{onSuccess:()=>{g(!1)},onFinish:()=>{j(!1)}})}catch(d){console.error("Form submission error",d)}}return e.jsxs(ae,{open:m,onOpenChange:g,children:[e.jsx(Ve,{asChild:!0,children:e.jsxs(u,{disabled:r,children:[e.jsx(W,{}),"Create License"]})}),e.jsxs(ie,{children:[e.jsxs(re,{children:[e.jsx(oe,{children:"Create License"}),e.jsx(le,{})]}),e.jsx(fe,{data:"products",fallback:e.jsx("div",{className:"flex items-center justify-center py-24",children:e.jsx(Q,{className:"animate-spin size-12 text-primary"})}),children:e.jsx(se,{...l,children:e.jsxs("form",{onSubmit:l.handleSubmit(P),className:"space-y-4",children:[e.jsx(f,{control:l.control,name:"product_id",render:({field:i})=>{var c;return e.jsxs(b,{children:[e.jsx(v,{children:"Product"}),e.jsxs(I,{onValueChange:d=>i.onChange(parseInt(d)),defaultValue:(c=i.value)==null?void 0:c.toString(),children:[e.jsx(y,{children:e.jsx(A,{children:e.jsx(K,{placeholder:"Select a product"})})}),e.jsx(q,{children:n.map(d=>e.jsxs(h,{value:d.id.toString(),children:[d.name," (",d.product_code,")"]},d.id))})]}),e.jsx(S,{})]})}}),e.jsxs("div",{className:"flex gap-4",children:[e.jsx(f,{control:l.control,name:"duration_value",render:({field:i})=>e.jsxs(b,{className:"flex-1",children:[e.jsx(v,{children:"Duration Amount"}),e.jsx(y,{children:e.jsxs("div",{className:"flex rounded-md shadow-xs",children:[e.jsx("span",{className:"border-input bg-background text-muted-foreground -z-10 inline-flex items-center rounded-s-md border px-3 text-sm",children:e.jsx(Xe,{className:"size-4"})}),e.jsx(V,{...i,min:1,type:"number",className:"-ms-px rounded-s-none shadow-none",onChange:c=>i.onChange(parseInt(c.target.value))})]})}),e.jsx(S,{})]})}),e.jsx(f,{control:l.control,name:"duration_unit",render:({field:i})=>e.jsxs(b,{className:"flex-1",children:[e.jsx(v,{children:"Duration Unit"}),e.jsxs(I,{onValueChange:i.onChange,defaultValue:i.value,children:[e.jsx(y,{children:e.jsxs("div",{className:"flex rounded-md shadow-xs",children:[e.jsx("span",{className:"border-input bg-background text-muted-foreground -z-10 inline-flex items-center rounded-s-md border px-3 text-sm",children:e.jsx(We,{className:"size-4"})}),e.jsx(A,{className:"-ms-px rounded-s-none shadow-none",children:e.jsx(K,{placeholder:"Select a duration"})})]})}),e.jsxs(q,{children:[e.jsx(h,{value:"hours",children:"Hours"}),e.jsx(h,{value:"days",children:"Days"}),e.jsx(h,{value:"weeks",children:"Weeks"}),e.jsx(h,{value:"months",children:"Months"}),e.jsx(h,{value:"years",children:"Years"}),e.jsx(h,{value:"lifetime",children:"Lifetime"})]})]}),e.jsx(S,{})]})})]}),e.jsx(f,{control:l.control,name:"amount",render:({field:i})=>e.jsxs(b,{children:[e.jsx(v,{children:"Amount"}),e.jsx(y,{children:e.jsx(V,{...i,type:"number",min:1,max:100,onChange:c=>i.onChange(parseInt(c.target.value))})}),e.jsx(S,{})]})}),e.jsx(f,{control:l.control,name:"description",render:({field:i})=>e.jsxs(b,{children:[e.jsx(v,{children:"Description"}),e.jsx(y,{children:e.jsx(ce,{placeholder:"Kiroshi's License for Pixelbot 3.0",className:"resize-none",...i})}),e.jsx(S,{})]})}),e.jsxs(He,{children:[e.jsx(C,{type:"submit",icon:Ee,loading:p,variant:"outline",onClick:()=>_("export"),disabled:!0,children:"Create & Export"}),e.jsx(C,{type:"submit",icon:W,loading:p,children:"Create"})]})]})})})]})]})},cs=({children:n})=>{const[r,m]=o.useState(!1),g=p=>{navigator.clipboard.writeText(n),m(!r),setTimeout(()=>{m(!1)},1e3)};return e.jsxs(Ge,{open:r,children:[e.jsx(Be,{children:e.jsx("label",{onClick:g,className:"px-2 py-1 rounded hover:text-white hover:bg-neutral-800 cursor-pointer transition-colors duration-200",children:n})}),e.jsx(Ue,{children:e.jsx("p",{children:"Copied to clipboard!"})})]})},de=({status:n})=>e.jsx("div",{className:te("capitalize border w-18 text-center",n==="active"?"bg-green-500/45 border-green-500/50 text-white":n==="expired"?"bg-red-500/45 border-red-500/50 text-white":n==="unused"?"bg-primary/45 border border-primary/50 text-white/70":n==="paused"?"bg-yellow-500/45 border-yellow-500/50 text-white":"bg-gray-500 text-white","py-0.5 rounded-md text-xs font-semibold"),children:n}),ds=async n=>{const{data:r}=await be.get(route("api.licenses.show",{license:n}));return r};function us({licenseId:n,enabled:r=!0}){return Oe({queryKey:["license",n],queryFn:()=>ds(n),staleTime:10,enabled:r})}const xs=O({duration_unit:L().min(1,"Duration unit is required"),duration_value:F().min(1,"Duration value is required")}),hs=O({status:L().min(1,"Status is required"),description:L().optional()}),ms=({open:n,onOpenChange:r,license:m})=>{const[g,p]=o.useState(!1),[j,w]=o.useState(!1),[_,l]=o.useState(!1),[P,i]=o.useState(!1),[c,d]=o.useState(!1),[J,M]=o.useState(null),{data:s,isPending:H,refetch:z}=us({licenseId:m.id,enabled:n}),t=B({resolver:U(xs),defaultValues:{duration_unit:"hours",duration_value:1}}),a=B({resolver:U(hs),defaultValues:{status:(s==null?void 0:s.status)||"active",description:(s==null?void 0:s.description)||""}});o.useEffect(()=>{s&&(a.reset({status:s.status,description:s.description||""}),z())},[s,a]),o.useEffect(()=>{const x=t.watch(R=>{if(R.duration_unit&&R.duration_value&&(s!=null&&s.time_left)){const je=ne(R.duration_unit,R.duration_value);M(s.time_left+je)}else M(null)});return()=>x.unsubscribe()},[t,s]);const E=(s==null?void 0:s.paused_at)!==null,ue=s&&s.status==="active",xe=s&&s.hwid!==null;function he(x){s&&(l(!0),D.put(route("licenses.update",{license:s.id}),x,{onSuccess:()=>{r(!1)},onFinish:()=>l(!1)}))}const me=()=>{s&&(p(!0),D.post(route("licenses.reset-hwid",{license:s.id}),{},{onSuccess:()=>{r(!1)},onFinish:()=>p(!1)}))},ge=()=>{if(!s)return;w(!0);const x=E?"licenses.unpause":"licenses.pause";D.post(route(x,{license:s.id}),{},{onSuccess:()=>{r(!1)},onFinish:()=>w(!1)})},pe=()=>{s&&(i(!0),D.delete(route("licenses.delete",{license:s.id}),{onSuccess:()=>{r(!1)},onFinish:()=>i(!1)}))};return e.jsx(ae,{open:n,onOpenChange:r,children:e.jsxs(ie,{children:[e.jsxs(re,{children:[e.jsx(oe,{children:"License Details"}),e.jsx(le,{})]}),H?e.jsx("div",{className:"h-full flex items-center justify-center",children:e.jsx(Q,{className:"size-12 animate-spin text-primary"})}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx($,{children:"License Key"}),e.jsxs("div",{className:"relative",children:[e.jsx(V,{className:"peer ps-9 pe-12",readOnly:!0,value:(s==null?void 0:s.license_key)||""}),e.jsx("div",{className:"text-muted-foreground/80 pointer-events-none absolute inset-y-0 start-0 flex items-center justify-center ps-3 peer-disabled:opacity-50",children:e.jsx(Qe,{className:"size-4"})}),e.jsx("span",{className:"text-muted-foreground pointer-events-none absolute inset-y-0 end-0 flex items-center justify-center pe-2 text-sm peer-disabled:opacity-50",children:e.jsx(de,{status:(s==null?void 0:s.c_status)||"unknown"})})]})]}),e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx($,{children:"Hardware ID"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("div",{className:"relative w-full",children:[e.jsx(V,{className:"peer ps-9",readOnly:!0,value:(s==null?void 0:s.hwid)||"Not assigned"}),e.jsx("div",{className:"text-muted-foreground/80 pointer-events-none absolute inset-y-0 start-0 flex items-center justify-center ps-3 peer-disabled:opacity-50",children:e.jsx(es,{className:"size-4"})})]}),e.jsx(C,{onClick:me,loading:g,icon:rs,disabled:!xe,children:"Reset"})]})]}),e.jsx(ee,{className:"my-2"}),e.jsx(se,{...a,children:e.jsxs("form",{onSubmit:a.handleSubmit(he),className:"space-y-4",children:[e.jsx(f,{control:a.control,name:"status",render:({field:x})=>e.jsxs(b,{children:[e.jsx(v,{children:"Change Status"}),e.jsxs(I,{onValueChange:x.onChange,value:x.value,children:[e.jsx(y,{children:e.jsx(A,{children:e.jsx(K,{})})}),e.jsxs(q,{children:[e.jsx(h,{value:"active",children:"Active"}),e.jsx(h,{value:"expired",children:"Expired"})]})]}),e.jsx(S,{})]})}),e.jsx(f,{control:a.control,name:"description",render:({field:x})=>e.jsxs(b,{children:[e.jsx(v,{children:"Description"}),e.jsx(y,{children:e.jsx(ce,{placeholder:"Kiroshi's License for Pixelbot 3.0",className:"resize-none",...x})}),e.jsx(S,{})]})}),e.jsx(ee,{className:"my-2"}),e.jsxs("div",{className:"flex w-full justify-between",children:[e.jsxs("div",{className:"flex gap-4",children:[e.jsx(C,{onClick:ge,loading:j,icon:E?as:ts,disabled:!ue,children:E?"Unpause":"Pause"}),e.jsx(C,{onClick:pe,loading:P,variant:"destructive",icon:ye,children:"Delete"})]}),e.jsx(C,{type:"submit",loading:_,icon:Se,children:"Save Changes"})]})]})})]})]})})},gs=({data:n=[],products:r=[]})=>{var z;console.log(n);const m=[{id:"select",header:({table:t})=>e.jsx(Z,{checked:t.getIsAllPageRowsSelected()||t.getIsSomePageRowsSelected()&&"indeterminate",onCheckedChange:a=>t.toggleAllPageRowsSelected(!!a),"aria-label":"Select all"}),cell:({row:t})=>e.jsx(Z,{checked:t.getIsSelected(),onCheckedChange:a=>t.toggleSelected(!!a),"aria-label":"Select row"}),enableSorting:!1,enableHiding:!1},{accessorKey:"license_key",header:({column:t})=>e.jsxs(u,{variant:"ghost",onClick:()=>t.toggleSorting(t.getIsSorted()==="asc"),children:["License Key",e.jsx(N,{})]}),cell:({row:t})=>e.jsx(cs,{children:t.getValue("license_key")})},{accessorKey:"product_name",header:({column:t})=>e.jsxs(u,{variant:"ghost",onClick:()=>t.toggleSorting(t.getIsSorted()==="asc"),children:["Product",e.jsx(N,{})]}),cell:({row:t})=>{var a;return e.jsx("span",{children:(a=t.original.product)==null?void 0:a.name})}},{accessorKey:"duration",header:({column:t})=>e.jsxs(u,{variant:"ghost",onClick:()=>t.toggleSorting(t.getIsSorted()==="asc"),children:["Duration",e.jsx(N,{})]}),cell:({row:t})=>e.jsx("span",{children:t.original.duration_human})},{accessorKey:"time_left",header:({column:t})=>e.jsxs(u,{variant:"ghost",onClick:()=>t.toggleSorting(t.getIsSorted()==="asc"),children:["Time Left",e.jsx(N,{})]}),cell:({row:t})=>e.jsx("span",{children:t.original.time_left>0?t.original.time_left_human:"N/A"})},{accessorKey:"status",header:({column:t})=>e.jsxs(u,{variant:"ghost",onClick:()=>t.toggleSorting(t.getIsSorted()==="asc"),children:["Status",e.jsx(N,{})]}),cell:({row:t})=>e.jsx(de,{status:t.original.c_status})},{accessorKey:"description",header:({column:t})=>e.jsxs(u,{variant:"ghost",onClick:()=>t.toggleSorting(t.getIsSorted()==="asc"),children:["Description",e.jsx(N,{})]}),cell:({row:t})=>e.jsx("span",{children:t.getValue("description")})},{accessorKey:"actions",header:({column:t})=>{},cell:({row:t})=>e.jsx("div",{className:"flex justify-end pr-4",children:e.jsx(u,{className:"size-8 text-primary",variant:"ghost",onClick:()=>H(t),children:e.jsx(Ke,{className:"size-4"})})})}],[g,p]=o.useState(!1),[j,w]=o.useState(null),[_,l]=o.useState([]),[P,i]=o.useState({}),[c,d]=o.useState(""),[J,M]=o.useState({pageIndex:0,pageSize:15}),s=we({data:n,columns:m,onSortingChange:l,getCoreRowModel:Ae(),getPaginationRowModel:Ie(),getSortedRowModel:Fe(),getFilteredRowModel:Te(),onRowSelectionChange:i,onGlobalFilterChange:d,onPaginationChange:M,state:{sorting:_,rowSelection:P,globalFilter:c,pagination:J}}),H=t=>{const a=t.original;w(a),p(!0)};return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"w-full",children:[e.jsxs("div",{className:"flex items-center py-4 gap-4",children:[e.jsx(ls,{products:r}),e.jsx(Ne,{value:c??"",onChange:t=>d(t),className:"w-96"})]}),e.jsx("div",{className:"rounded-md border bg-background overflow-hidden",children:e.jsxs(Ce,{children:[e.jsx(ke,{children:s.getHeaderGroups().map(t=>e.jsx(G,{className:"bg-sidebar",children:t.headers.map(a=>e.jsx(_e,{children:a.isPlaceholder?null:Y(a.column.columnDef.header,a.getContext())},a.id))},t.id))}),e.jsx(Pe,{children:(z=s.getRowModel().rows)!=null&&z.length?s.getRowModel().rows.map(t=>e.jsx(G,{"data-state":t.getIsSelected()&&"selected",className:"odd:bg-muted/50 odd:hover:bg-muted/50 border-none hover:bg-transparent",children:t.getVisibleCells().map(a=>e.jsx(X,{className:"py-1",children:Y(a.column.columnDef.cell,a.getContext())},a.id))},t.id)):e.jsx(G,{children:e.jsx(X,{colSpan:m.length,className:"h-24 text-center",children:e.jsx(ve,{data:"licenses",fallback:e.jsx("div",{className:"flex items-center justify-center",children:e.jsx(Q,{className:"animate-spin size-8 text-primary"})}),children:"No results."})})})})]})}),e.jsxs("div",{className:"flex items-center justify-between gap-8 py-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx($,{className:"max-sm:sr-only",children:"Rows per page"}),e.jsxs(I,{value:s.getState().pagination.pageSize.toString(),onValueChange:t=>{s.setPageSize(Number(t))},children:[e.jsx(A,{className:"w-fit whitespace-nowrap",children:e.jsx(K,{placeholder:"Select number of results"})}),e.jsx(q,{className:"[&_*[role=option]]:ps-2 [&_*[role=option]]:pe-8 [&_*[role=option]>span]:start-auto [&_*[role=option]>span]:end-2",children:[5,10,15,25,50,100].map(t=>e.jsx(h,{value:t.toString(),children:t},t))})]})]}),e.jsx("div",{className:"text-muted-foreground flex grow justify-end text-sm whitespace-nowrap",children:e.jsxs("p",{className:"text-muted-foreground text-sm whitespace-nowrap","aria-live":"polite",children:[e.jsxs("span",{className:"text-foreground",children:[s.getState().pagination.pageIndex*s.getState().pagination.pageSize+1,"-",Math.min(Math.max(s.getState().pagination.pageIndex*s.getState().pagination.pageSize+s.getState().pagination.pageSize,0),s.getRowCount())]})," ","of"," ",e.jsx("span",{className:"text-foreground",children:s.getRowCount().toString()})]})}),e.jsx("div",{children:e.jsx(De,{children:e.jsxs(Le,{children:[e.jsx(T,{children:e.jsx(u,{size:"icon",variant:"outline",className:"disabled:pointer-events-none disabled:opacity-50",onClick:()=>s.firstPage(),disabled:!s.getCanPreviousPage(),"aria-label":"Go to first page",children:e.jsx(Me,{size:16,"aria-hidden":"true"})})}),e.jsx(T,{children:e.jsx(u,{size:"icon",variant:"outline",className:"disabled:pointer-events-none disabled:opacity-50",onClick:()=>s.previousPage(),disabled:!s.getCanPreviousPage(),"aria-label":"Go to previous page",children:e.jsx(ze,{size:16,"aria-hidden":"true"})})}),e.jsx(T,{children:e.jsx(u,{size:"icon",variant:"outline",className:"disabled:pointer-events-none disabled:opacity-50",onClick:()=>s.nextPage(),disabled:!s.getCanNextPage(),"aria-label":"Go to next page",children:e.jsx($e,{size:16,"aria-hidden":"true"})})}),e.jsx(T,{children:e.jsx(u,{size:"icon",variant:"outline",className:"disabled:pointer-events-none disabled:opacity-50",onClick:()=>s.lastPage(),disabled:!s.getCanNextPage(),"aria-label":"Go to last page",children:e.jsx(Re,{size:16,"aria-hidden":"true"})})})]})})})]})]}),g&&j&&e.jsx(ms,{open:g,onOpenChange:p,license:j})]})},ps=[{title:"Licenses",href:route("licenses.index")}];function zs({licenses:n,products:r}){return e.jsx(qe,{title:"Licenses",breadcrumbs:ps,children:e.jsx(gs,{data:n,products:r})})}export{zs as default};
